   Building cs336-systems @ file:///home/c-tadimeti/language-model-basics
   Building cs336-basics @ file:///home/c-tadimeti/language-model-basics/cs336-basics
      Built cs336-basics @ file:///home/c-tadimeti/language-model-basics/cs336-basics
      Built cs336-systems @ file:///home/c-tadimeti/language-model-basics
Uninstalled 12 packages in 75ms
Installed 25 packages in 93ms
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:24<05:46, 24.79s/it] 13%|█▎        | 2/15 [00:44<04:42, 21.76s/it] 47%|████▋     | 7/15 [00:44<00:33,  4.20s/it] 67%|██████▋   | 10/15 [00:44<00:22,  4.46s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:23<05:33, 23.84s/it] 13%|█▎        | 2/15 [00:43<04:34, 21.13s/it] 40%|████      | 6/15 [00:43<00:43,  4.87s/it] 67%|██████▋   | 10/15 [00:43<00:11,  2.34s/it] 67%|██████▋   | 10/15 [00:43<00:21,  4.33s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:24<05:40, 24.34s/it] 13%|█▎        | 2/15 [00:44<04:42, 21.74s/it] 27%|██▋       | 4/15 [00:44<01:29,  8.14s/it] 40%|████      | 6/15 [00:44<00:38,  4.32s/it] 53%|█████▎    | 8/15 [00:44<00:18,  2.60s/it] 67%|██████▋   | 10/15 [00:44<00:08,  1.67s/it] 67%|██████▋   | 10/15 [00:44<00:22,  4.47s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:24<05:46, 24.77s/it] 13%|█▎        | 2/15 [00:44<04:40, 21.59s/it] 20%|██        | 3/15 [00:44<02:21, 11.78s/it] 27%|██▋       | 4/15 [00:44<01:18,  7.17s/it] 33%|███▎      | 5/15 [00:44<00:46,  4.62s/it] 40%|████      | 6/15 [00:44<00:27,  3.08s/it] 47%|████▋     | 7/15 [00:44<00:16,  2.11s/it] 53%|█████▎    | 8/15 [00:44<00:10,  1.47s/it] 60%|██████    | 9/15 [00:44<00:06,  1.04s/it] 67%|██████▋   | 10/15 [00:44<00:03,  1.33it/s] 67%|██████▋   | 10/15 [00:44<00:22,  4.50s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:41<09:34, 41.03s/it] 13%|█▎        | 2/15 [01:17<08:21, 38.55s/it] 27%|██▋       | 4/15 [01:17<02:38, 14.42s/it] 40%|████      | 6/15 [01:18<01:08,  7.63s/it] 53%|█████▎    | 8/15 [01:18<00:32,  4.58s/it] 67%|██████▋   | 10/15 [01:18<00:14,  2.93s/it] 67%|██████▋   | 10/15 [01:18<00:39,  7.83s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:41<09:36, 41.16s/it] 13%|█▎        | 2/15 [01:18<08:28, 39.09s/it] 27%|██▋       | 4/15 [01:18<02:40, 14.64s/it] 40%|████      | 6/15 [01:19<01:09,  7.76s/it] 53%|█████▎    | 8/15 [01:19<00:32,  4.67s/it] 67%|██████▋   | 10/15 [01:19<00:14,  3.00s/it] 67%|██████▋   | 10/15 [01:19<00:39,  7.95s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:40<09:32, 40.93s/it] 13%|█▎        | 2/15 [01:17<08:22, 38.65s/it] 20%|██        | 3/15 [01:18<04:12, 21.07s/it] 27%|██▋       | 4/15 [01:18<02:20, 12.81s/it] 33%|███▎      | 5/15 [01:18<01:22,  8.25s/it] 40%|████      | 6/15 [01:18<00:49,  5.49s/it] 47%|████▋     | 7/15 [01:18<00:29,  3.75s/it] 53%|█████▎    | 8/15 [01:18<00:18,  2.60s/it] 60%|██████    | 9/15 [01:19<00:11,  1.84s/it] 67%|██████▋   | 10/15 [01:19<00:06,  1.32s/it] 67%|██████▋   | 10/15 [01:19<00:39,  7.92s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:41<09:35, 41.11s/it] 13%|█▎        | 2/15 [01:18<08:26, 38.98s/it] 20%|██        | 3/15 [01:18<04:15, 21.32s/it] 27%|██▋       | 4/15 [01:19<02:23, 13.02s/it] 33%|███▎      | 5/15 [01:19<01:24,  8.44s/it] 40%|████      | 6/15 [01:19<00:51,  5.67s/it] 47%|████▋     | 7/15 [01:20<00:31,  3.92s/it] 53%|█████▎    | 8/15 [01:20<00:19,  2.77s/it] 60%|██████    | 9/15 [01:20<00:11,  2.00s/it] 67%|██████▋   | 10/15 [01:21<00:07,  1.47s/it] 67%|██████▋   | 10/15 [01:21<00:40,  8.10s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:58<13:39, 58.53s/it] 13%|█▎        | 2/15 [01:53<12:15, 56.59s/it] 20%|██        | 3/15 [01:53<06:09, 30.81s/it] 27%|██▋       | 4/15 [01:54<03:25, 18.70s/it] 33%|███▎      | 5/15 [01:54<02:00, 12.00s/it] 40%|████      | 6/15 [01:54<01:11,  7.97s/it] 47%|████▋     | 7/15 [01:54<00:43,  5.40s/it] 53%|█████▎    | 8/15 [01:54<00:26,  3.73s/it] 60%|██████    | 9/15 [01:54<00:15,  2.60s/it] 67%|██████▋   | 10/15 [01:54<00:09,  1.84s/it] 67%|██████▋   | 10/15 [01:54<00:57, 11.48s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:57<13:19, 57.07s/it] 13%|█▎        | 2/15 [01:51<12:01, 55.49s/it] 20%|██        | 3/15 [01:51<06:03, 30.25s/it] 27%|██▋       | 4/15 [01:51<03:22, 18.39s/it] 33%|███▎      | 5/15 [01:52<01:58, 11.84s/it] 40%|████      | 6/15 [01:52<01:10,  7.88s/it] 47%|████▋     | 7/15 [01:52<00:43,  5.38s/it] 53%|█████▎    | 8/15 [01:52<00:26,  3.73s/it] 60%|██████    | 9/15 [01:52<00:15,  2.63s/it] 67%|██████▋   | 10/15 [01:53<00:09,  1.89s/it] 67%|██████▋   | 10/15 [01:53<00:56, 11.32s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:57<13:25, 57.55s/it] 13%|█▎        | 2/15 [01:52<12:06, 55.92s/it] 20%|██        | 3/15 [01:52<06:06, 30.55s/it] 27%|██▋       | 4/15 [01:53<03:24, 18.63s/it] 33%|███▎      | 5/15 [01:53<02:00, 12.04s/it] 40%|████      | 6/15 [01:53<01:12,  8.07s/it] 47%|████▋     | 7/15 [01:54<00:44,  5.55s/it] 53%|█████▎    | 8/15 [01:54<00:27,  3.90s/it] 60%|██████    | 9/15 [01:54<00:16,  2.79s/it] 67%|██████▋   | 10/15 [01:55<00:10,  2.04s/it] 67%|██████▋   | 10/15 [01:55<00:57, 11.52s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:58<13:44, 58.91s/it] 13%|█▎        | 2/15 [01:54<12:23, 57.21s/it] 20%|██        | 3/15 [01:55<06:16, 31.40s/it] 27%|██▋       | 4/15 [01:56<03:32, 19.28s/it] 33%|███▎      | 5/15 [01:57<02:05, 12.58s/it] 40%|████      | 6/15 [01:57<01:16,  8.54s/it] 47%|████▋     | 7/15 [01:58<00:47,  5.97s/it] 53%|█████▎    | 8/15 [01:59<00:30,  4.29s/it] 60%|██████    | 9/15 [01:59<00:18,  3.17s/it] 67%|██████▋   | 10/15 [02:00<00:12,  2.40s/it] 67%|██████▋   | 10/15 [02:00<01:00, 12.05s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [01:17<17:58, 77.03s/it] 13%|█▎        | 2/15 [02:31<16:19, 75.33s/it] 20%|██        | 3/15 [02:31<08:12, 41.04s/it] 27%|██▋       | 4/15 [02:31<04:34, 24.94s/it] 33%|███▎      | 5/15 [02:31<02:40, 16.03s/it] 40%|████      | 6/15 [02:32<01:35, 10.67s/it] 47%|████▋     | 7/15 [02:32<00:58,  7.26s/it] 53%|█████▎    | 8/15 [02:32<00:35,  5.03s/it] 60%|██████    | 9/15 [02:32<00:21,  3.53s/it] 67%|██████▋   | 10/15 [02:33<00:12,  2.52s/it] 67%|██████▋   | 10/15 [02:33<01:16, 15.31s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [01:16<17:56, 76.87s/it] 13%|█▎        | 2/15 [02:30<16:15, 75.04s/it] 20%|██        | 3/15 [02:31<08:11, 40.96s/it] 27%|██▋       | 4/15 [02:31<04:34, 24.94s/it] 33%|███▎      | 5/15 [02:31<02:40, 16.09s/it] 40%|████      | 6/15 [02:32<01:36, 10.76s/it] 47%|████▋     | 7/15 [02:32<00:58,  7.37s/it] 53%|█████▎    | 8/15 [02:33<00:36,  5.15s/it] 60%|██████    | 9/15 [02:33<00:21,  3.67s/it] 67%|██████▋   | 10/15 [02:33<00:13,  2.66s/it] 67%|██████▋   | 10/15 [02:33<01:16, 15.38s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [01:16<17:56, 76.87s/it] 13%|█▎        | 2/15 [02:30<16:13, 74.86s/it] 20%|██        | 3/15 [02:31<08:12, 41.01s/it] 27%|██▋       | 4/15 [02:31<04:36, 25.10s/it] 33%|███▎      | 5/15 [02:32<02:43, 16.31s/it] 40%|████      | 6/15 [02:33<01:39, 11.01s/it] 47%|████▋     | 7/15 [02:33<01:01,  7.64s/it] 53%|█████▎    | 8/15 [02:34<00:38,  5.44s/it] 60%|██████    | 9/15 [02:35<00:23,  3.96s/it] 67%|██████▋   | 10/15 [02:36<00:14,  2.96s/it] 67%|██████▋   | 10/15 [02:36<01:18, 15.61s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [01:16<17:57, 76.98s/it]  7%|▋         | 1/15 [02:09<30:17, 129.82s/it]
Traceback (most recent call last):
  File "/home/c-tadimeti/language-model-basics/cs336_systems/benchmarking_script.py", line 227, in <module>
    profile(cfg)
    ~~~~~~~^^^^^
  File "/home/c-tadimeti/language-model-basics/cs336_systems/benchmarking_script.py", line 101, in profile
    logits = model(xb)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_dynamo/eval_frame.py", line 574, in _fn
    return fn(*args, **kwargs)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/c-tadimeti/language-model-basics/cs336-basics/cs336_basics/transformer_modules.py", line 383, in forward
    def forward(self, in_indices: torch.Tensor) -> torch.Tensor:
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_dynamo/eval_frame.py", line 745, in _fn
    return fn(*args, **kwargs)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/aot_autograd.py", line 1184, in forward
    return compiled_fn(full_args)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 310, in runtime_wrapper
    all_outs = call_func_at_runtime_with_args(
        compiled_fn, args_, disable_amp=disable_amp, steal_args=True
    )
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
    out = normalize_as_list(f(args))
                            ~^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/utils.py", line 100, in g
    return f(*args)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/autograd/function.py", line 575, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 1585, in forward
    fw_outs = call_func_at_runtime_with_args(
        CompiledFunction.compiled_fw,
        args,
        disable_amp=disable_amp,
    )
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
    out = normalize_as_list(f(args))
                            ~^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 490, in wrapper
    return compiled_fn(runtime_args)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 672, in inner_fn
    outs = compiled_fn(args)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/output_code.py", line 466, in __call__
    return self.current_callable(inputs)
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/utils.py", line 2128, in run
    return model(new_inputs)
  File "/tmp/torchinductor_c-tadimeti/73/c73bxyi5vrhkkam5nofpy6rmp3vahwufa443tzyqi7hgmodh3htu.py", line 5649, in call
    buf1272 = empty_strided_cuda((4, 25, 1024, 1024), (26214400, 1048576, 1024, 1), torch.float32)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 400.00 MiB. GPU 0 has a total capacity of 79.19 GiB of which 215.06 MiB is free. Including non-PyTorch memory, this process has 78.97 GiB memory in use. Of the allocated memory 77.07 GiB is allocated by PyTorch, and 1.18 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:52<12:18, 52.78s/it] 13%|█▎        | 2/15 [01:41<10:57, 50.58s/it] 20%|██        | 3/15 [01:42<05:31, 27.66s/it] 27%|██▋       | 4/15 [01:42<03:05, 16.89s/it] 33%|███▎      | 5/15 [01:42<01:49, 10.94s/it] 40%|████      | 6/15 [01:43<01:06,  7.35s/it] 47%|████▋     | 7/15 [01:43<00:40,  5.07s/it] 53%|█████▎    | 8/15 [01:44<00:25,  3.58s/it] 60%|██████    | 9/15 [01:44<00:15,  2.58s/it] 67%|██████▋   | 10/15 [01:44<00:09,  1.90s/it] 67%|██████▋   | 10/15 [01:44<00:52, 10.49s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:52<12:10, 52.16s/it] 13%|█▎        | 2/15 [01:40<10:52, 50.16s/it] 20%|██        | 3/15 [01:41<05:30, 27.54s/it] 27%|██▋       | 4/15 [01:42<03:05, 16.91s/it] 33%|███▎      | 5/15 [01:42<01:50, 11.03s/it] 40%|████      | 6/15 [01:43<01:07,  7.49s/it] 47%|████▋     | 7/15 [01:43<00:41,  5.24s/it] 53%|█████▎    | 8/15 [01:44<00:26,  3.77s/it] 60%|██████    | 9/15 [01:45<00:16,  2.78s/it] 67%|██████▋   | 10/15 [01:45<00:10,  2.11s/it] 67%|██████▋   | 10/15 [01:45<00:52, 10.58s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:53<12:23, 53.11s/it] 13%|█▎        | 2/15 [01:42<11:03, 51.06s/it] 20%|██        | 3/15 [01:43<05:38, 28.24s/it] 27%|██▋       | 4/15 [01:44<03:12, 17.52s/it] 33%|███▎      | 5/15 [01:46<01:55, 11.60s/it] 40%|████      | 6/15 [01:47<01:12,  8.03s/it] 47%|████▋     | 7/15 [01:48<00:46,  5.76s/it] 53%|█████▎    | 8/15 [01:49<00:29,  4.27s/it] 60%|██████    | 9/15 [01:50<00:19,  3.28s/it] 67%|██████▋   | 10/15 [01:51<00:13,  2.61s/it] 67%|██████▋   | 10/15 [01:51<00:55, 11.15s/it]
Exception ignored in: <_io.BufferedWriter name=49>
BrokenPipeError: [Errno 32] Broken pipe
  0%|          | 0/15 [00:00<?, ?it/s]/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  7%|▋         | 1/15 [00:54<12:41, 54.37s/it]  7%|▋         | 1/15 [01:29<20:59, 89.93s/it]
Traceback (most recent call last):
  File "/home/c-tadimeti/language-model-basics/cs336_systems/benchmarking_script.py", line 227, in <module>
    profile(cfg)
    ~~~~~~~^^^^^
  File "/home/c-tadimeti/language-model-basics/cs336_systems/benchmarking_script.py", line 101, in profile
    logits = model(xb)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_dynamo/eval_frame.py", line 574, in _fn
    return fn(*args, **kwargs)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/c-tadimeti/language-model-basics/cs336-basics/cs336_basics/transformer_modules.py", line 383, in forward
    def forward(self, in_indices: torch.Tensor) -> torch.Tensor:
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_dynamo/eval_frame.py", line 745, in _fn
    return fn(*args, **kwargs)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/aot_autograd.py", line 1184, in forward
    return compiled_fn(full_args)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 310, in runtime_wrapper
    all_outs = call_func_at_runtime_with_args(
        compiled_fn, args_, disable_amp=disable_amp, steal_args=True
    )
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
    out = normalize_as_list(f(args))
                            ~^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/utils.py", line 100, in g
    return f(*args)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/autograd/function.py", line 575, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 1585, in forward
    fw_outs = call_func_at_runtime_with_args(
        CompiledFunction.compiled_fw,
        args,
        disable_amp=disable_amp,
    )
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
    out = normalize_as_list(f(args))
                            ~^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 490, in wrapper
    return compiled_fn(runtime_args)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 672, in inner_fn
    outs = compiled_fn(args)
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/output_code.py", line 466, in __call__
    return self.current_callable(inputs)
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/scratch/c-tadimeti/uv-envs/language-model-basics/lib/python3.13/site-packages/torch/_inductor/utils.py", line 2128, in run
    return model(new_inputs)
  File "/tmp/torchinductor_c-tadimeti/vx/cvxgga7nyak3qrxpn234euo3qrsl26crtrcaokdwmyz34enln4ct.py", line 2981, in call
    buf505 = empty_strided_cuda((1, 10240, 4096), (41943040, 4096, 1), torch.float32)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 160.00 MiB. GPU 0 has a total capacity of 79.19 GiB of which 75.06 MiB is free. Including non-PyTorch memory, this process has 79.11 GiB memory in use. Of the allocated memory 68.99 GiB is allocated by PyTorch, and 9.39 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
